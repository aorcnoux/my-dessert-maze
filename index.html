<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    if(document.referrer === '' || !document.referrer.includes(landing)){
      window.location.replace('landing.html')
    }
  </script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Dessert MazeğŸ§</title>
  <link rel="shortcut icon" href="./img/favicon.svg" type="image/x-icon" />
  <link rel="stylesheet" href="./css/materialize.min.css" />
  <link rel="stylesheet" href="./css/index.css" />
  <script>
// æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦æœ‰æ¬Šé™è¨ªå• index é é¢
function checkAccess() {
    const hasVisitedLanding = sessionStorage.getItem('hasVisitedLanding');
    const allowIndex = sessionStorage.getItem('allowIndex');
    
    // å¦‚æœæ²’æœ‰è¨ªå•é landing page æˆ–æ²’æœ‰å…è¨±æ¨™è¨˜ï¼Œå°±é‡å®šå‘
    if (!hasVisitedLanding || !allowIndex) {
        window.location.replace('landing.html');
        return;
    }
    
    // æ¸…é™¤å…è¨±æ¨™è¨˜ï¼Œé€™æ¨£é‡æ–°æ•´ç†æ™‚å°±æœƒè·³è½‰
    sessionStorage.removeItem('allowIndex');
}

// é é¢è¼‰å…¥æ™‚ç«‹å³æª¢æŸ¥
checkAccess();

// ç›£è½é é¢å³å°‡é›¢é–‹çš„äº‹ä»¶ï¼ˆåŒ…æ‹¬é‡æ–°æ•´ç†ï¼‰
window.addEventListener('beforeunload', function() {
    // ç¢ºä¿é‡æ–°æ•´ç†æ™‚æœƒè·³è½‰åˆ° landing page
    sessionStorage.removeItem('allowIndex');
});
</script>
</head>

<body class="teal lighten-4" style="background: url('./img/cute-bg.png') no-repeat center center fixed; background-size: cover;">

  <div class="container center-align"style="margin-top: 6vh;">
    <div class="row"></div>

    <!-- Maze -->
    <div class="row">
      <div class="maze">
        <!-- Maze canvas -->
        <canvas id="maze-map" class="z-depth-5"></canvas>
        <!-- Ball -->
        <div id="maze-ball"></div>
      </div>
    </div>

    <!-- Controls -->
    <div class="row center-align">
      <div class="control teal col s12 m6 offset-m3 card-panel z-depth-3 row">
        <!-- Maze size -->
        <div class="row valign-wrapper" style="margin-bottom: 0;">
          <div class="col s5">
            <p class="teal-text text-lighten-5 control-label-left">ğŸ«åœ°åœ–å¤§å°ï¼š</p>
          </div>
          <div class="range-field col s7">
            <input type="range" class="maze-size teal lighten-2" value="31" min="31" max="101" step="2" />
          </div>
        </div>

        <!-- Game level -->
        <div class="row valign-wrapper" style="margin-top: 0;">
          <div class="col s5">
            <p class="teal-text text-lighten-5 control-label-left">ğŸ«éŠæˆ²é›£åº¦ï¼š</p>
          </div>
          <div class="col s7">
            <select class="game-level browser-default">
              <option value="0" selected>ç°¡å–®ğŸ¬</option>
              <option value="2">å›°é›£ğŸ¬ğŸ¬</option>
              <option value="1">è¤‡é›œğŸ¬ğŸ¬ğŸ¬</option>
            </select>
          </div>
        </div>

        <!-- Game control buttons -->
        <div class="row">
          <div class="col s6">
            <button class="start-game btn waves-effect waves-light teal-text text-lighten-5" onclick="startGame()">ğŸ­é–‹å§‹éŠæˆ²</button>
          </div>
          <div class="col s6">
            <button class="btn waves-effect offset-m3 waves-light teal-text text-lighten-5" onclick="reGenMaze()">ğŸ­é‡æ–°ç”Ÿæˆ</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Hint button -->
    <div class="fixed-action-btn">
      <a class="game-hint btn-floating btn-large scale-transition waves-effect waves-light z-depth-3 teal lighten-1 scale-out" onclick="drawHintPath()">æç¤º</a>
    </div>

    <!-- Modal -->
    <div class="row">
      <a class="waves-effect waves-light btn modal-trigger" href="#modal-surprise">Modal</a>
      <div id="modal-surprise" class="modal">
        <div class="modal-content">
          <div class="fireworks"></div>
          <div class="surprise-msg">
            <h4 class="cute-text">æ­å–œéé—œ</h4>

            <style>
              .cute-text {
                font-family: "Comic Sans MS", "Chalkboard SE", "Comic Neue", cursive, sans-serif; /* å¯æ„›é¢¨å­—é«” */
                font-weight: bold; /* ç²—é«” */
                color: #ff8ec5; /* å¤¢å¹»ç²‰è‰² */
                text-shadow: 1px 1px 3px #ffc6e3; /* åŠ æŸ”å’Œé™°å½±å¢åŠ å¤¢å¹»æ„Ÿ */
                font-size: 10em; /* å­—ç¨å¾®å¤§ä¸€é» */
              }
            </style>

<p class="white-text text-darken-4 center-align big-bold-text">æ­å–œç²å¾—é˜¿å”èŒ¶å…·</p>
<p class="big-bold-text">âœ¨ğŸ‰ğŸµğŸ™‚â€â†•ï¸ğŸ™‚â€âœ¨</p>
<p class="white-text text-darken-4 center-align big-bold-text">ç›´æ¥çµ¦ä½ 4ï¸âƒ£å€‹å­—ğŸ«µğŸ»</p>
<p class="red-text text-darken-4 center-align big-bold-text white-outline">å¤§å±•é´»åœ–ğŸ¦… æœ‰æ–™ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»</p>

<style>
  .big-bold-text {
    font-size: 1.8em;
    font-weight: bold;
  }

  .white-outline {
    text-shadow:
      -1px -1px 0 #fff,
       1px -1px 0 #fff,
      -1px  1px 0 #fff,
       1px  1px 0 #fff; /* å››æ–¹å‘æç™½é‚Š */
  }
</style>


<a href="landing.html" class="close-btn-style waves-effect btn-flat right">é—œé–‰</a>

          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="./js/materialize.min.js"></script>
  <script>
    M.AutoInit();
    document.addEventListener('DOMContentLoaded', function () {
      var elms = document.querySelectorAll('.modal');
      var instances = M.Modal.init(elms, { endingTop: '0' });
    });
  </script>
  <script src="./js/jquery.min.js"></script>
  <script src="./js/jquery.fireworks.min.js"></script>
  <script src="./js/maze.js"></script>
</body>
</html>
